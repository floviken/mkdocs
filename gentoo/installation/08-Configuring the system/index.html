
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="https://floviken.github.io/mkdocs/gentoo/installation/08-Configuring%20the%20system/">
      
      
        <link rel="prev" href="../07-Configuring%20the%20linux%20kernel/">
      
      
        <link rel="next" href="../09-Installing%20system%20tools/">
      
      <link rel="icon" href="../../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.5.1, mkdocs-material-9.1.21">
    
    
      
        <title>Configuring the system - KaboliDocs</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/main.eebd395e.min.css">
      
        
        <link rel="stylesheet" href="../../../assets/stylesheets/palette.ecc896b0.min.css">
      
      

    
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
      
        <meta  property="og:type"  content="website" >
      
        <meta  property="og:title"  content="Configuring the system - KaboliDocs" >
      
        <meta  property="og:description"  content="None" >
      
        <meta  property="og:image"  content="https://floviken.github.io/mkdocs/assets/images/social/gentoo/installation/08-Configuring the system.png" >
      
        <meta  property="og:image:type"  content="image/png" >
      
        <meta  property="og:image:width"  content="1200" >
      
        <meta  property="og:image:height"  content="630" >
      
        <meta  property="og:url"  content="https://floviken.github.io/mkdocs/gentoo/installation/08-Configuring%20the%20system/" >
      
        <meta  name="twitter:card"  content="summary_large_image" >
      
        <meta  name="twitter:title"  content="Configuring the system - KaboliDocs" >
      
        <meta  name="twitter:description"  content="None" >
      
        <meta  name="twitter:image"  content="https://floviken.github.io/mkdocs/assets/images/social/gentoo/installation/08-Configuring the system.png" >
      
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="purple">
  
    
    
      <script>var palette=__md_get("__palette");if(palette&&"object"==typeof palette.color)for(var key of Object.keys(palette.color))document.body.setAttribute("data-md-color-"+key,palette.color[key])</script>
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#configuring-the-system" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../.." title="KaboliDocs" class="md-header__button md-logo" aria-label="KaboliDocs" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            KaboliDocs
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Configuring the system
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
          
            
            
            
            <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="purple"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_1">
            
              <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_2" hidden>
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 6H7c-3.31 0-6 2.69-6 6s2.69 6 6 6h10c3.31 0 6-2.69 6-6s-2.69-6-6-6zm0 10H7c-2.21 0-4-1.79-4-4s1.79-4 4-4h10c2.21 0 4 1.79 4 4s-1.79 4-4 4zM7 9c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3z"/></svg>
              </label>
            
          
            
            
            
            <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="orange" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_2">
            
              <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_1" hidden>
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h10a5 5 0 0 0 5-5 5 5 0 0 0-5-5m0 8a3 3 0 0 1-3-3 3 3 0 0 1 3-3 3 3 0 0 1 3 3 3 3 0 0 1-3 3Z"/></svg>
              </label>
            
          
        </form>
      
    
    
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  


  <li class="md-tabs__item">
    <a href="../../.." class="md-tabs__link">
      Welcome to MkDocs
    </a>
  </li>

      
        
  
  


  <li class="md-tabs__item">
    <a href="../../../ssh/" class="md-tabs__link">
      SSH setup
    </a>
  </li>

      
        
  
  
    
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../" class="md-tabs__link md-tabs__link--active">
        Gentoo
      </a>
    </li>
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

  


  

<nav class="md-nav md-nav--primary md-nav--lifted md-nav--integrated" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../.." title="KaboliDocs" class="md-nav__button md-logo" aria-label="KaboliDocs" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    KaboliDocs
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../.." class="md-nav__link">
        Welcome to MkDocs
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../../ssh/" class="md-nav__link">
        SSH setup
      </a>
    </li>
  

    
      
      
      

  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" checked>
      
      
      
        <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
          Gentoo
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="true">
        <label class="md-nav__title" for="__nav_3">
          <span class="md-nav__icon md-icon"></span>
          Gentoo
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../" class="md-nav__link">
        gentoo handbook
      </a>
    </li>
  

            
          
            
              
  
  
    
  
  
    
      
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_2" checked>
      
      
      
        <label class="md-nav__link" for="__nav_3_2" id="__nav_3_2_label" tabindex="0">
          Installation
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_2_label" aria-expanded="true">
        <label class="md-nav__title" for="__nav_3_2">
          <span class="md-nav__icon md-icon"></span>
          Installation
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../01-About%20the%20Gentoo%20Linux%20Installation/" class="md-nav__link">
        About the Gentoo Linux Installation
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../010-Configuring%20the%20bootloader/" class="md-nav__link">
        Configuring the bootloader
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../02-Choosing%20the%20right%20installation%20medium/" class="md-nav__link">
        Choosing the right installation medium
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../03-Configuring%20the%20network/" class="md-nav__link">
        Configuring the network
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../04-Preparing%20the%20disks/" class="md-nav__link">
        Preparing the disks
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../05-Installing%20the%20Gentoo%20installation%20files/" class="md-nav__link">
        Installing the Gentoo installation files
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../06-Installing%20the%20Gentoo%20base%20system/" class="md-nav__link">
        Installing the Gentoo base system
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../07-Configuring%20the%20linux%20kernel/" class="md-nav__link">
        Configuring the Linux kernel
      </a>
    </li>
  

            
          
            
              
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          Configuring the system
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        Configuring the system
      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#filesystem-information" class="md-nav__link">
    Filesystem information
  </a>
  
    <nav class="md-nav" aria-label="Filesystem information">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#about-fstab" class="md-nav__link">
    About fstab
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#creating-the-fstab-file" class="md-nav__link">
    Creating the fstab file
  </a>
  
    <nav class="md-nav" aria-label="Creating the fstab file">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#filesystem-labels-and-uuids" class="md-nav__link">
    Filesystem labels and UUIDs
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#partition-labels-and-uuids" class="md-nav__link">
    Partition labels and UUIDs
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#networking-information" class="md-nav__link">
    Networking information
  </a>
  
    <nav class="md-nav" aria-label="Networking information">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#hostname" class="md-nav__link">
    Hostname
  </a>
  
    <nav class="md-nav" aria-label="Hostname">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#set-the-hostname-openrc-or-systemd" class="md-nav__link">
    Set the hostname (OpenRC or systemd)
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#systemd" class="md-nav__link">
    systemd
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#network" class="md-nav__link">
    Network
  </a>
  
    <nav class="md-nav" aria-label="Network">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#dhcp-via-dhcpcd-any-init-system" class="md-nav__link">
    DHCP via dhcpcd (any init system)
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#netifrc-openrc" class="md-nav__link">
    netifrc (OpenRC)
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#configuring-the-network" class="md-nav__link">
    Configuring the network
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#automatically-start-networking-at-boot" class="md-nav__link">
    Automatically start networking at boot
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#the-hosts-file" class="md-nav__link">
    The hosts file
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#system-information" class="md-nav__link">
    System information
  </a>
  
    <nav class="md-nav" aria-label="System information">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#root-password" class="md-nav__link">
    Root password
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#init-and-boot-configuration" class="md-nav__link">
    Init and boot configuration
  </a>
  
    <nav class="md-nav" aria-label="Init and boot configuration">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#openrc" class="md-nav__link">
    OpenRC
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#systemd_1" class="md-nav__link">
    systemd
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../09-Installing%20system%20tools/" class="md-nav__link">
        Installing system tools
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
      
      
      
        
      
      <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_3_3" >
      
      
      
        <label class="md-nav__link" for="__nav_3_3" id="__nav_3_3_label" tabindex="0">
          Working with gentoo
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_3_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_3_3">
          <span class="md-nav__icon md-icon"></span>
          Working with gentoo
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../working_with_gentoo/01-Portage/" class="md-nav__link">
        Working with Gentoo
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../working_with_gentoo/02-Use/" class="md-nav__link">
        What are USE flags
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../working_with_gentoo/03-Features/" class="md-nav__link">
        Portage features
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../working_with_gentoo/04-Initscripts/" class="md-nav__link">
        Runlevels
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../working_with_gentoo/05-EnvVar/" class="md-nav__link">
        Environment variables
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
      
      
      
        
      
      <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_3_4" >
      
      
      
        <label class="md-nav__link" for="__nav_3_4" id="__nav_3_4_label" tabindex="0">
          Working with portage
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_4_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_3_4">
          <span class="md-nav__icon md-icon"></span>
          Working with portage
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../working_with_portage/01-Files/" class="md-nav__link">
        01 Files
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


<h1 id="configuring-the-system">Configuring the system</h1>
<h2 id="filesystem-information">Filesystem information</h2>
<h3 id="about-fstab">About fstab</h3>
<p>Under Linux, all partitions used by the system must be listed in <a href="https://wiki.gentoo.org/wiki//etc/fstab">/etc/fstab</a>. This file contains the mount points of those partitions (where they are seen in the file system structure), how they should be mounted and with what special options (automatically or not, whether users can mount them or not, etc.)</p>
<h3 id="creating-the-fstab-file">Creating the fstab file</h3>
<p>The /etc/fstab file uses a table-like syntax. Every line consists of six fields, separated by whitespace (space(s), tabs, or a mixture of the two). Each field has its own meaning:</p>
<ol>
<li>The first field shows the block special device or remote filesystem to be mounted. Several kinds of device identifiers are available for block special device nodes, including paths to device files, filesystem labels and UUIDs, and partition labels and UUIDs.</li>
<li>The second field shows the mount point at which the partition should be mounted.
3.The third field shows the type of filesystem used by the partition.</li>
<li>The fourth field shows the mount options used by <strong>mount</strong> when it wants to mount the partition. As every filesystem has its own mount options, so system admins are encouraged to read the mount man page (<strong>man mount</strong>) for a full listing. Multiple mount options are comma-separated.</li>
<li>The fifth field is used by dump to determine if the partition needs to be dumped or not. This can generally be left as <code>0</code> (zero).</li>
<li>The sixth field is used by <strong>fsck</strong> to determine the order in which filesystems should be checked if the system wasn't shut down properly. The root filesystem should have <code>1</code> while the rest should have <code>2</code> (or <code>0</code> if a filesystem check is not necessary).</li>
</ol>
<div class="admonition important">
<p class="admonition-title">Important</p>
</div>
<p>The default /etc/fstab file provided in Gentoo stage files is not a valid fstab file but instead a template that can be used to enter in relevant values.</p>
<p><code>root # nano /etc/fstab</code></p>
<p>In the remainder of the text, the default /dev/sd* block device files will be used as partition identifiers.</p>
<h4 id="filesystem-labels-and-uuids">Filesystem labels and UUIDs</h4>
<p>Both MBR (BIOS) and GPT include support for <em>filesystem</em> labels and <em>filesystem</em> UUIDs. These attributes can be defined in /etc/fstab as alternatives for the <strong>mount</strong> command to use when attempting to find and mount block devices. Filesystem labels and UUIDs are identified by the <em>LABEL</em> and <em>UUID</em> prefix and can be viewed with the <strong>blkid</strong> command:</p>
<p><code>root # blkid</code></p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
</div>
<p>If the filesystem inside a partition is wiped, then the filesystem label and the UUID values will be subsequently altered or removed.
Because of uniqueness, readers that are using an MBR-style partition table are recommended to use UUIDs over labels to define mountable volumes in /etc/fstab.</p>
<div class="admonition important">
<p class="admonition-title">Important</p>
</div>
<p>UUIDs of the filesystem on a LVM volume and its LVM snapshots are identical, therefore using UUIDs to mount LVM volumes should be avoided.</p>
<h4 id="partition-labels-and-uuids">Partition labels and UUIDs</h4>
<p>Users who have gone the GPT route have a couple more 'robust' options available to define partitions in /etc/fstab. Partition labels and partition UUIDs can be used to identify the block device's individual partition(s), regardless of what filesystem has been chosen for the partition itself. Partition labels and UUIDs are identified by the <em>PARTLABEL</em> and <em>PARTUUID</em> prefixes respectively and can be viewed nicely in the terminal by running the <strong>blkid</strong> command:</p>
<p><code>root # blkid</code></p>
<p>While not always true for partition labels, using a UUID to identify a partition in fstab provides a guarantee that the bootloader will not be confused when looking for a certain volume, even if the filesystem would be changed in the future. Using the older default block device files (/dev/sd*N) for defining the partitions in fstab is risky for systems that are restarted often and have SATA block devices added and removed regularly.</p>
<p>The naming for block device files depends on a number of factors, including how and in what order the disks are attached to the system. They also could show up in a different order depending on which of the devices are detected by the kernel first during the early boot process. With this being stated, unless one intends to constantly fiddle with the disk ordering, using default block device files is a simple and straightforward approach.</p>
<p>Let us take a look at how to write down the options for the /boot/ partition. This is just an example, and should be modified according to the partitioning decisions made earlier in the installation. In our amd64 partitioning example, /boot/ is usually the /dev/sda1 partition, with xfs as filesystem. It needs to be checked during boot, so we would write down:</p>
<div class="highlight"><span class="filename">FILE /etc/fstabAn example /boot line for /etc/fstab</span><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="c1"># Adjust any formatting difference from the Preparing the disks step</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a>/dev/sda1<span class="w">   </span>/boot<span class="w">     </span>vfat<span class="w">    </span>defaults<span class="w">        </span><span class="m">0</span><span class="w"> </span><span class="m">2</span>
</code></pre></div>
<p>Some users don't want their /boot/ partition to be mounted automatically to improve their system's security. Those people should substitute <em>defaults</em> with <em>noauto</em>. This does mean that those users will need to manually mount this partition every time they want to use it.</p>
<p>Add the rules that match the previously decided partitioning scheme and append rules for devices such as CD-ROM drive(s), and of course, if other partitions or drives are used, for those too.</p>
<p>Below is a more elaborate example of an /etc/fstab file:</p>
<div class="highlight"><span class="filename">FILE /etc/fstabA full /etc/fstab example</span><pre><span></span><code><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a><span class="c1"># Adjust any formatting difference and additional partitions created from the Preparing the disks step</span>
<a id="__codelineno-1-2" name="__codelineno-1-2" href="#__codelineno-1-2"></a>/dev/sda1<span class="w">   </span>/boot<span class="w">        </span>vfat<span class="w">    </span>defaults<span class="w">    </span><span class="m">0</span><span class="w"> </span><span class="m">2</span>
<a id="__codelineno-1-3" name="__codelineno-1-3" href="#__codelineno-1-3"></a>/dev/sda2<span class="w">   </span>none<span class="w">         </span>swap<span class="w">    </span>sw<span class="w">                   </span><span class="m">0</span><span class="w"> </span><span class="m">0</span>
<a id="__codelineno-1-4" name="__codelineno-1-4" href="#__codelineno-1-4"></a>/dev/sda3<span class="w">   </span>/<span class="w">            </span>xfs<span class="w">    </span>defaults,noatime<span class="w">              </span><span class="m">0</span><span class="w"> </span><span class="m">1</span>
<a id="__codelineno-1-5" name="__codelineno-1-5" href="#__codelineno-1-5"></a>
<a id="__codelineno-1-6" name="__codelineno-1-6" href="#__codelineno-1-6"></a>/dev/cdrom<span class="w">  </span>/mnt/cdrom<span class="w">   </span>auto<span class="w">    </span>noauto,user<span class="w">          </span><span class="m">0</span><span class="w"> </span><span class="m">0</span>
</code></pre></div>
<p>When <code>auto</code> is used in the third field, it makes the <strong>mount</strong> command guess what the filesystem would be. This is recommended for removable media as they can be created with one of many filesystems. The user option in the fourth field makes it possible for non-root users to mount the CD.</p>
<p>To improve performance, most users would want to add the noatime mount option, which results in a faster system since access times are not registered (those are not needed generally anyway). This is also recommended for systems with solid state drives (SSDs). Users may wish to consider lazytime instead.</p>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
</div>
<p>Due to degradation in performance, defining the <code>discard</code> mount option in /etc/fstab is not recommended. It is generally better to schedule block discards on a periodic basis using a job scheduler such as cron or a timer (systemd). See <a href="https://wiki.gentoo.org/wiki/SSD#Periodic_fstrim_jobs">Periodic fstrim jobs</a> for more information.
Double-check the /etc/fstab file, save and quit to continue.</p>
<h2 id="networking-information">Networking information</h2>
<p>It is important to note the following sections are provided to help the reader quickly setup their system to partake in a local area network.</p>
<p>For systems running OpenRC, a more detailed reference for network setup is available in the <a href="https://wiki.gentoo.org/wiki/Handbook:AMD64/Networking/Introduction">advanced network configuration</a> section, which is covered near the end of the handbook. Systems with more specific network needs may need to skip ahead, then return here to continue with the rest of the installation.</p>
<p>For more specific systemd network setup, please review see the <a href="https://wiki.gentoo.org/wiki/Systemd#Network">networking portion</a>of the <a href="https://wiki.gentoo.org/wiki/Systemd">systemd</a> article.</p>
<h3 id="hostname">Hostname</h3>
<p>One of the choices the system administrator has to make is name their PC. This seems to be quite easy, but lots of users are having difficulties finding the appropriate name for the hostname. To speed things up, know that the decision is not final - it can be changed afterwards. In the examples below, the hostname tux is used.</p>
<h4 id="set-the-hostname-openrc-or-systemd">Set the hostname (OpenRC or systemd)</h4>
<p><code>root # echo tux &gt; /etc/hostname</code></p>
<h4 id="systemd">systemd</h4>
<p>To set the system hostname for a system currently running systemd, the <strong>hostnamectl</strong> utility may be used. During the installation process however, systemd-firstboot command must be used instead (see later on in handbook).</p>
<p>For setting the hostname to "tux", one would run:</p>
<p><code>root # hostnamectl hostname tux</code></p>
<p>View help by running <strong>hostnamectl --help</strong> or <strong>man 1 hostnamectl.</strong></p>
<h3 id="network">Network</h3>
<p>There are <em>many</em> options available for configuring network interfaces. This section covers a only a few methods. Choose the one which seems best suited to the setup needed.</p>
<h4 id="dhcp-via-dhcpcd-any-init-system">DHCP via dhcpcd (any init system)</h4>
<p>Most LAN networks operate a DHCP server. If this is the case, then using the dhcpcd program to obtain an IP address is recommended.</p>
<p>To install:</p>
<p><code>root # emerge --ask net-misc/dhcpcd</code></p>
<p>To enable and then start the service on OpenRC systems:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-2-1" name="__codelineno-2-1" href="#__codelineno-2-1"></a>root<span class="w"> </span><span class="c1"># rc-update add dhcpcd default</span>
<a id="__codelineno-2-2" name="__codelineno-2-2" href="#__codelineno-2-2"></a>root<span class="w"> </span><span class="c1"># rc-service dhcpcd start</span>
</code></pre></div>
<p>To enable and start the service on systemd systems:</p>
<p><code>root # systemctl enable --now dhcpcd</code></p>
<p>With these steps completed, next time the system boots, dhcpcd should obtain an IP address from the DHCP server. See the <a href="https://wiki.gentoo.org/wiki/Dhcpcd">Dhcpcd</a> article for more details.</p>
<h4 id="netifrc-openrc">netifrc (OpenRC)</h4>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
</div>
<p>This is one particular way of setting up the network using <a href="https://wiki.gentoo.org/wiki/Netifrc">Netifrc</a> on OpenRC. Other methods exist for simpler setups like Dhcpcd.</p>
<h4 id="configuring-the-network">Configuring the network</h4>
<p>During the Gentoo Linux installation, networking was already configured. However, that was for the live environment itself and not for the installed environment. Right now, the network configuration is made for the installed Gentoo Linux system.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
</div>
<p>More detailed information about networking, including advanced topics like bonding, bridging, 802.1Q VLANs or wireless networking is covered in the <a href="https://wiki.gentoo.org/wiki/Handbook:AMD64/Networking/Introduction">advanced network configuration</a> section.</p>
<p>All networking information is gathered in /etc/conf.d/net. It uses a straightforward - yet perhaps not intuitive - syntax. Do not fear! Everything is explained below. A fully commented example that covers many different configurations is available in /usr/share/doc/netifrc-*/net.example.bz2.</p>
<p>First install <a href="https://packages.gentoo.org/packages/net-misc/netifrc">net-misc/netifrc</a>:</p>
<p><code>root # emerge --ask --noreplace net-misc/netifrc</code></p>
<p>DHCP is used by default. For DHCP to work, a DHCP client needs to be installed. This is described later in Installing Necessary System Tools.</p>
<p>If the network connection needs to be configured because of specific DHCP options or because DHCP is not used at all, then open /etc/conf.d/net:</p>
<p><code>root # nano /etc/conf.d/net</code></p>
<p>Set both <em>config_eth0</em> and <em>routes_eth0</em> to enter IP address information and routing information:</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
</div>
<p>This assumes that the network interface will be called eth0. This is, however, very system dependent. It is recommended to assume that the interface is named the same as the interface name when booted from the installation media if the installation media is sufficiently recent. More information can be found in the <a href="https://wiki.gentoo.org/wiki/Handbook:AMD64/Networking/Advanced#Network_interface_naming">Network interface naming</a> section.</p>
<div class="highlight"><span class="filename">FILE /etc/conf.d/netStatic IP definition</span><pre><span></span><code><a id="__codelineno-3-1" name="__codelineno-3-1" href="#__codelineno-3-1"></a><span class="nv">config_eth0</span><span class="o">=</span><span class="s2">&quot;192.168.0.2 netmask 255.255.255.0 brd 192.168.0.255&quot;</span>
<a id="__codelineno-3-2" name="__codelineno-3-2" href="#__codelineno-3-2"></a><span class="nv">routes_eth0</span><span class="o">=</span><span class="s2">&quot;default via 192.168.0.1&quot;</span>
</code></pre></div>
<p>To use DHCP, define <em>config_eth0</em>:</p>
<div class="highlight"><span class="filename">FILE /etc/conf.d/netDHCP definition</span><pre><span></span><code><a id="__codelineno-4-1" name="__codelineno-4-1" href="#__codelineno-4-1"></a><span class="nv">config_eth0</span><span class="o">=</span><span class="s2">&quot;dhcp&quot;</span>
</code></pre></div>
<p>Please read /usr/share/doc/netifrc-*/net.example.bz2 for a list of additional configuration options. Be sure to also read up on the DHCP client man page if specific DHCP options need to be set.</p>
<p>If the system has several network interfaces, then repeat the above steps for <em>config_eth1</em>, <em>config_eth2</em>, etc.</p>
<p>Now save the configuration and exit to continue.</p>
<h4 id="automatically-start-networking-at-boot">Automatically start networking at boot</h4>
<p>To have the network interfaces activated at boot, they need to be added to the default runlevel.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-5-1" name="__codelineno-5-1" href="#__codelineno-5-1"></a>root<span class="w"> </span><span class="c1">#cd /etc/init.d</span>
<a id="__codelineno-5-2" name="__codelineno-5-2" href="#__codelineno-5-2"></a>root<span class="w"> </span><span class="c1">#ln -s net.lo net.eth0</span>
<a id="__codelineno-5-3" name="__codelineno-5-3" href="#__codelineno-5-3"></a>root<span class="w"> </span><span class="c1">#rc-update add net.eth0 default</span>
</code></pre></div>
<p>If the system has several network interfaces, then the appropriate net.* files need to be created just like we did with net.eth0.</p>
<p>If, after booting the system, it is discovered the network interface name (which is currently documented as eth0) was wrong, then execute the following steps to rectify:</p>
<ol>
<li>Update the /etc/conf.d/net file with the correct interface name (like enp3s0 or enp5s0, instead of eth0).</li>
<li>Create new symbolic link (like /etc/init.d/net.enp3s0).</li>
<li>Remove the old symbolic link (<strong>rm /etc/init.d/net.eth0</strong>).</li>
<li>Add the new one to the default runlevel.</li>
<li>Remove the old one using <strong>rc-update del net.eth0 default</strong>.</li>
</ol>
<h3 id="the-hosts-file">The hosts file</h3>
<p>An important next step may be to inform this new system about other hosts in its network environment. Network host names can be defined in the /etc/hosts file. Adding host names here will enable host name to IP addresses resolution for hosts that are not resolved by the nameserver.</p>
<p><code>root #nano /etc/hosts</code></p>
<div class="highlight"><span class="filename">FILE /etc/hostsFilling in the networking information</span><pre><span></span><code><a id="__codelineno-6-1" name="__codelineno-6-1" href="#__codelineno-6-1"></a><span class="c1"># This defines the current system and must be set</span>
<a id="__codelineno-6-2" name="__codelineno-6-2" href="#__codelineno-6-2"></a><span class="m">127</span>.0.0.1<span class="w">     </span>tux.homenetwork<span class="w"> </span>tux<span class="w"> </span>localhost
<a id="__codelineno-6-3" name="__codelineno-6-3" href="#__codelineno-6-3"></a>
<a id="__codelineno-6-4" name="__codelineno-6-4" href="#__codelineno-6-4"></a><span class="c1"># Optional definition of extra systems on the network</span>
<a id="__codelineno-6-5" name="__codelineno-6-5" href="#__codelineno-6-5"></a><span class="m">192</span>.168.0.5<span class="w">   </span>jenny.homenetwork<span class="w"> </span>jenny
<a id="__codelineno-6-6" name="__codelineno-6-6" href="#__codelineno-6-6"></a><span class="m">192</span>.168.0.6<span class="w">   </span>benny.homenetwork<span class="w"> </span>benny
</code></pre></div>
<p>Save and exit the editor to continue.</p>
<h2 id="system-information">System information</h2>
<h3 id="root-password">Root password</h3>
<p>Set the root password using the passwd command.</p>
<p><code>root # passwd</code></p>
<p>Later an additional regular user account will be created for daily operations.</p>
<h3 id="init-and-boot-configuration">Init and boot configuration</h3>
<h4 id="openrc">OpenRC</h4>
<p>When using OpenRC with Gentoo, it uses /etc/rc.conf to configure the services, startup, and shutdown of a system. Open up /etc/rc.conf and enjoy all the comments in the file. Review the settings and change where needed.</p>
<p><code>root # nano /etc/rc.conf</code></p>
<p>Next, open /etc/conf.d/keymaps to handle keyboard configuration. Edit it to configure and select the right keyboard.</p>
<p><code>root # nano /etc/conf.d/keymaps</code></p>
<p>Take special care with the keymap variable. If the wrong keymap is selected, then weird results will come up when typing on the keyboard.</p>
<p>Finally, edit /etc/conf.d/hwclock to set the clock options. Edit it according to personal preference.</p>
<p><code>root # nano /etc/conf.d/hwclock</code></p>
<p>If the hardware clock is not using UTC, then it is necessary to set clock="local" in the file. Otherwise the system might show clock skew behavior.</p>
<h4 id="systemd_1">systemd</h4>
<p>First, it is recommended to run <strong>systemd-firstboot</strong> which will prepare various components of the system are set correctly for the first boot into the new systemd environment. The passing the following options will include a prompt for the user to set a locale, timezone, hostname, root password, and root shell values. It will also assign a random machine ID to the installation:</p>
<p><code>root # systemd-firstboot --prompt --setup-machine-id</code></p>
<p>Next users should run systemctl to reset all installed unit files to the preset policy values:</p>
<p><code>root # systemctl preset-all --preset-mode=enable-only</code></p>
<p>It's possible to run the full preset changes but this may reset any services which were already configured during the process:</p>
<p><code>root # systemctl preset-all</code></p>
<p>These two steps will help ensure a smooth transition from the live environment to the installation's first boot.</p>





                
              </article>
            </div>
          
          
  <script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var tab,labels=set.querySelector(".tabbed-labels");for(tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script>

        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12Z"/></svg>
            Back to top
          </button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      &copy; 2023 <a href="https://github.com/floviken"  target="_blank" rel="noopener">kaboli</a>

    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
        <div class="md-social">
  
    
    
    
    
      
      
    
    <a href="https://github.com/floviken" target="_blank" rel="noopener" title="github.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 480 512"><!--! Font Awesome Free 6.4.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M186.1 328.7c0 20.9-10.9 55.1-36.7 55.1s-36.7-34.2-36.7-55.1 10.9-55.1 36.7-55.1 36.7 34.2 36.7 55.1zM480 278.2c0 31.9-3.2 65.7-17.5 95-37.9 76.6-142.1 74.8-216.7 74.8-75.8 0-186.2 2.7-225.6-74.8-14.6-29-20.2-63.1-20.2-95 0-41.9 13.9-81.5 41.5-113.6-5.2-15.8-7.7-32.4-7.7-48.8 0-21.5 4.9-32.3 14.6-51.8 45.3 0 74.3 9 108.8 36 29-6.9 58.8-10 88.7-10 27 0 54.2 2.9 80.4 9.2 34-26.7 63-35.2 107.8-35.2 9.8 19.5 14.6 30.3 14.6 51.8 0 16.4-2.6 32.7-7.7 48.2 27.5 32.4 39 72.3 39 114.2zm-64.3 50.5c0-43.9-26.7-82.6-73.5-82.6-18.9 0-37 3.4-56 6-14.9 2.3-29.8 3.2-45.1 3.2-15.2 0-30.1-.9-45.1-3.2-18.7-2.6-37-6-56-6-46.8 0-73.5 38.7-73.5 82.6 0 87.8 80.4 101.3 150.4 101.3h48.2c70.3 0 150.6-13.4 150.6-101.3zm-82.6-55.1c-25.8 0-36.7 34.2-36.7 55.1s10.9 55.1 36.7 55.1 36.7-34.2 36.7-55.1-10.9-55.1-36.7-55.1z"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    <script id="__config" type="application/json">{"base": "../../..", "features": ["navigation.tabs", "navigation.tracking", "navigation.sections", "navigation.sections", "navigation.expand", "navigation.top", "toc.integrate", "search.suggest", "search.highlight", "content.tabs.link", "content.code.annotation", "content.code.copy"], "search": "../../../assets/javascripts/workers/search.74e28a9f.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../../../assets/javascripts/bundle.220ee61c.min.js"></script>
      
    
  </body>
</html>